# Update Notes v0.3.0 to v0.4.0

Check the [github release notes](https://github.com/ui-schema/ui-schema/releases) for latest releases, this page focuses on breaking changes of core logic.

> ðŸš§ `v0.4.0` is the *next version*, **fix the version exactly!**
>
> *for now* `v0.4.0-alpha` only includes [`mui@v5` #167](https://github.com/ui-schema/ui-schema/issues/167) changes and no other breaking changes

## Material v5

Updates `material-ui@4` to `mui@v5`, please consult [mui.com for the theme migration](https://mui.com/material-ui/guides/migration-v4).

> ðŸš§ atm. `@mui/styles` is required as `peerDepencency`, will be removed after migration is finished

### MUI Pickers

The pickers where rewritten for the new [MUI-X pickers package](https://mui.com/x/react-date-pickers/getting-started/).

See [new docs](/docs/material-pickers/Overview) vs [old docs](/docs/widgets/DateTimePickers).

> ðŸš§ they do not support all old (`<=v0.3.0`) features yet and are very-basic (only handling *basic* `value`-parsing/`onChange`)
>
> e.g. custom `x` format is not supported yet

## React Version

- `@ui-schema/ui-schema` still supports `v16.8`, and now up to `v18`
    - same for `@ui-schema/pro`
    - same for `@ui-schema/kit-dnd`
- `@ui-schema/ds-material` (and material packages) now only support `v17` or `v18`
    - same for `@ui-schema/material-*`

## Deprecations

As preparation for the refactoring in `v0.5.0`, some components are now already `deprecated` and will be removed in the future.

- `UIProvider` -> use `UIMetaProvider` and `UIStoreProvider` on their own
- `UIGenerator` -> use the provider setup together with (for the moment) `UIRootRenderer`
- `UIRootRenderer`/`widgets.RootRenderer` -> use the provider setup together with e.g. a `GridContainer` component from your design-system and `injectPluginStack`
- `ownKey` in `PluginStack`/`WidgetProps` and especially as usage in `TransTitle`
    - you just need to remove it from custom widgets, if you didn't "misused" the prop nothing else will happen
    - use `storeKeys.last()` when previously consumed the prop `ownKey`
    - `TransTitle` doesn't use `ownKey` internally (as it also uses `storeKeys.last()` now), but until `v0.5.0` if `ownKey` is passed down - and not `undefined` it will use the value
    - typing `OwnKey`, use `KeyType` instead
    - the `requiredValidator` now also uses `storeKeys.last()`

## Example UIRootRenderer Replacement

```typescript jsx
import React from 'react'
import { OrderedMap } from 'immutable'
import { createOrderedMap, createStore, injectPluginStack, JsonSchema, UIStoreActions, UIStoreProvider } from '@ui-schema/ui-schema'
import { storeUpdater } from '@ui-schema/ui-schema/storeUpdater'
import { GridContainer } from '@ui-schema/ds-material/GridContainer'

const formSchema = createOrderedMap({
    type: 'object',
    properties: {
        name: {
            type: 'string',
        },
        value: {
            type: 'number',
        },
        message: {
            type: 'string',
            widget: 'Text',
        },
    },
} as JsonSchema)

// wiring up the "dumb" component `GridContainer`, previously this was done inside `UIRootRenderer`
const GridStack = injectPluginStack(GridContainer)
const FormComp = () => {
    const [store, setStore] = React.useState(() => createStore(OrderedMap()))

    const onChange = React.useCallback((actions: UIStoreActions[] | UIStoreActions) => {
        setStore(storeUpdater(actions))
    }, [setStore])

    return <UIStoreProvider
        store={store}
        onChange={onChange}
        showValidity
    >
        {/* this `GridStack` is typed like the `PluginStack` */}
        {/* `isRoot=true` in `AppliedPluginStackProps` allows using `PluginStack` without `storeKeys`/`parentSchema` */}
        <GridStack isRoot schema={formSchema}/>
    </UIStoreProvider>
}
```
